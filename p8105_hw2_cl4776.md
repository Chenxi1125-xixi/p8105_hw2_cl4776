p8105_hw2_cl4776
================
Chenxi Liu
2025-09-30

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
library(lubridate)
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'
    ## 
    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

# Problem 1

## clean the data in pols_month.csv

``` r
pols = read_csv("data/pols-month.csv") |> 
   separate(mon, into = c("year", "month", "day"), sep = "-") |>
   mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day),
   
    month = month.name[month],
  
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem"
    )
  ) |>
  select(-day, -prez_gop, -prez_dem)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

## clean the data in snp.csv

``` r
snp = read_csv("data/snp.csv") |>
  mutate(
    date  = mdy(date),
    year  = year(date),
    month_num = month(date),
    month = factor(month.name[month_num], levels = month.name) 
  ) |>
  arrange(year, month_num) |>
  select(year, month, close, -date, -month_num)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <dbl> <fct>     <dbl>
    ##  1  1969 January   103. 
    ##  2  1969 February   98.1
    ##  3  1969 March     102. 
    ##  4  1969 April     104. 
    ##  5  1969 May       103. 
    ##  6  1969 June       97.7
    ##  7  1969 July       91.8
    ##  8  1969 August     95.5
    ##  9  1969 September  93.1
    ## 10  1969 October    97.1
    ## # ℹ 777 more rows

## Tidy the unemplyment data

``` r
unemployment = read_csv("data/unemployment.csv") |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month", 
    values_to = "unemployment"
  ) |>
  mutate(
    year = as.integer(Year),
    month = month.name[match(month, month.abb)]
  ) |>
  select(year, month, unemployment) |>
  arrange(year, match(month, month.name))
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <int> <chr>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # ℹ 806 more rows

## Merge with previous data and describle these three datasets

``` r
pols_snp = left_join(pols, snp, by = c("year", "month"))

final_data = left_join(pols_snp, unemployment, by = c("year", "month"))

dim(final_data)      
```

    ## [1] 822  11

``` r
range(final_data$year)  
```

    ## [1] 1947 2015

``` r
names(final_data)    
```

    ##  [1] "year"         "month"        "gov_gop"      "sen_gop"      "rep_gop"     
    ##  [6] "gov_dem"      "sen_dem"      "rep_dem"      "president"    "close"       
    ## [11] "unemployment"

The **pols-month** dataset contains counts of national politicians by
party and the president’s affiliation, the **snp** dataset provides
monthly closing values of the S&P 500 index, and the **unemployment**
dataset gives monthly unemployment rates. After tidying and merging by
year and month, the resulting dataset has 822 rows and 11 columns,
covers the years 1947–2015, and includes key variables such as `year`,
`month`, `president`, `close`, and `unemployment`.

# Problem 2

## Read and clean Mr. Trash Wheel data

``` r
mr_trash  = read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Mr. Trash Wheel",
    skip = 1        
  ) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>               
  mutate(
    sports_balls = as.integer(round(sports_balls)),
    trash_wheel = "Mr"
  )
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

## Professor Trash Wheel

``` r
prof_trash = read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Professor Trash Wheel",
    skip = 1
  ) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster))

if(!"sports_balls" %in%  names(prof_trash)) {
  prof_trash = prof_trash |> mutate(sports_balls = NA_integer_)
}

prof_trash = prof_trash |> mutate(trash_wheel = "Professor")
```

## Gwynnda Trash Wheel

``` r
gwynnda_trash = read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx",
    sheet = "Gwynnda Trash Wheel",
    skip = 1
  ) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  select(where(~!all(is.na(.)))) 

if(!"sports_balls" %in% names(gwynnda_trash)) {
  gwynnda_trash = gwynnda_trash |> mutate(sports_balls = NA_integer_)
}

gwynnda_trash = gwynnda_trash |> mutate(trash_wheel = "Gwynnda")
```
